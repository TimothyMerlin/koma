<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Estimating Klein's Model I • koma</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimating Klein's Model I">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">koma</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/timothymerlin/koma" aria-label="koma on GitHub"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimating Klein's Model I</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/timothymerlin/koma/blob/0.2.1/vignettes/koma-klein.Rmd" class="external-link"><code>vignettes/koma-klein.Rmd</code></a></small>
      <div class="d-none name"><code>koma-klein.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="equations-of-kleins-model">Equations of Klein’s Model<a class="anchor" aria-label="anchor" href="#equations-of-kleins-model"></a>
</h2>
<div class="section level3">
<h3 id="stochastic-equations">Stochastic equations<a class="anchor" aria-label="anchor" href="#stochastic-equations"></a>
</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">consumption</mtext><mspace width="1.0em"></mspace><msub><mi>C</mi><mi>t</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>α</mi><mn>1</mn></msub><msub><mi>P</mi><mi>t</mi></msub><mo>+</mo><msub><mi>α</mi><mn>2</mn></msub><msub><mi>P</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>α</mi><mn>3</mn></msub><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><msubsup><mi>W</mi><mi>t</mi><mi>p</mi></msubsup><mo>+</mo><msubsup><mi>W</mi><mi>t</mi><mi>g</mi></msubsup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo><mo>+</mo><msub><mi>ε</mi><mrow><mn>1</mn><mi>t</mi></mrow></msub><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">investment</mtext><mspace width="1.0em"></mspace><msub><mi>I</mi><mi>t</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mi>P</mi><mi>t</mi></msub><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><msub><mi>P</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub><msub><mi>K</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>ε</mi><mrow><mn>2</mn><mi>t</mi></mrow></msub><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">private wages</mtext><mspace width="1.0em"></mspace><msubsup><mi>W</mi><mi>t</mi><mi>p</mi></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>γ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>γ</mi><mn>1</mn></msub><msub><mi>Y</mi><mi>t</mi></msub><mo>+</mo><msub><mi>γ</mi><mn>2</mn></msub><msub><mi>Y</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>γ</mi><mn>3</mn></msub><msub><mi>A</mi><mi>t</mi></msub><mo>+</mo><msub><mi>ε</mi><mrow><mn>3</mn><mi>t</mi></mrow></msub><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
\text{consumption}\quad   C_t     &amp;= \beta_0 + \alpha_1 P_t + \alpha_2 P_{t-1}
                                   + \alpha_3\bigl(W^p_t + W^g_t\bigr)
                                   + \varepsilon_{1t},\\
\text{investment}\quad    I_t     &amp;= \beta_0  + \beta_1 P_t + \beta_2 P_{t-1}
                                   + \beta_3 K_{t-1}
                                   + \varepsilon_{2t},\\
\text{private wages}\quad W^p_t   &amp;= \gamma_0 + \gamma_1 Y_t + \gamma_2 Y_{t-1}
                                   + \gamma_3 A_t
                                   + \varepsilon_{3t}.
\end{aligned}
</annotation></semantics></math></p>
<p>The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>’s,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>’s,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>’s
are the coefficients of the model.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mi>t</mi></msub><annotation encoding="application/x-tex">P_t</annotation></semantics></math>
is the private profits,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>W</mi><mi>t</mi><mi>p</mi></msubsup><annotation encoding="application/x-tex">W^p_t</annotation></semantics></math>
is the private wages,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>W</mi><mi>t</mi><mi>g</mi></msubsup><annotation encoding="application/x-tex">W^g_t</annotation></semantics></math>
is the government wages,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">K_{t-1}</annotation></semantics></math>
is the capital stock at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t-1</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>t</mi></msub><annotation encoding="application/x-tex">A_t</annotation></semantics></math>
is a time trend. The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ε</mi><mrow><mi>i</mi><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">\varepsilon_{it}</annotation></semantics></math>
are stochastic error terms.</p>
</div>
<div class="section level3">
<h3 id="equilibrium-condition">Equilibrium condition<a class="anchor" aria-label="anchor" href="#equilibrium-condition"></a>
</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">equilibrium demand</mtext><mspace width="1.0em"></mspace><msub><mi>Y</mi><mi>t</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>C</mi><mi>t</mi></msub><mo>+</mo><msub><mi>I</mi><mi>t</mi></msub><mo>+</mo><msub><mi>G</mi><mi>t</mi></msub></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
\text{equilibrium demand}\quad Y_t &amp;= C_t + I_t + G_t
\end{aligned}
</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>t</mi></msub><annotation encoding="application/x-tex">Y_t</annotation></semantics></math>
is the equilibrium demand,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>t</mi></msub><annotation encoding="application/x-tex">C_t</annotation></semantics></math>
is the consumption,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mi>t</mi></msub><annotation encoding="application/x-tex">I_t</annotation></semantics></math>
is the investment, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>G</mi><mi>t</mi></msub><annotation encoding="application/x-tex">G_t</annotation></semantics></math>
is the government spending.</p>
</div>
<div class="section level3">
<h3 id="identities">Identities<a class="anchor" aria-label="anchor" href="#identities"></a>
</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">equilibrium demand</mtext><mspace width="1.0em"></mspace><msub><mi>Y</mi><mi>t</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>C</mi><mi>t</mi></msub><mo>+</mo><msub><mi>I</mi><mi>t</mi></msub><mo>+</mo><msub><mi>G</mi><mi>t</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">private profits</mtext><mspace width="1.0em"></mspace><msub><mi>P</mi><mi>t</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>Y</mi><mi>t</mi></msub><mo>−</mo><msub><mi>T</mi><mi>t</mi></msub><mo>−</mo><msubsup><mi>W</mi><mi>t</mi><mi>p</mi></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">capital stock</mtext><mspace width="1.0em"></mspace><msub><mi>K</mi><mi>t</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>K</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>I</mi><mi>t</mi></msub></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
\text{equilibrium demand}\quad Y_t &amp;= C_t + I_t + G_t\\
\text{private profits}\quad P_t &amp;= Y_t - T_t - W^p_t\\
\text{capital stock}\quad K_t &amp;= K_{t-1} + I_t
\end{aligned}
</annotation></semantics></math></p>
<p>Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>t</mi></msub><annotation encoding="application/x-tex">T_t</annotation></semantics></math>
represents taxes,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>t</mi></msub><annotation encoding="application/x-tex">K_t</annotation></semantics></math>
denotes the capital stock at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>G</mi><mi>t</mi></msub><annotation encoding="application/x-tex">G_t</annotation></semantics></math>
signifies government spending.</p>
</div>
</div>
<div class="section level2">
<h2 id="defining-kleins-model-in-r">Defining Klein’s Model in R<a class="anchor" aria-label="anchor" href="#defining-kleins-model-in-r"></a>
</h2>
<p>To estimate and forecast this model, we need to specify the
equations, the exogenous variables, and the date ranges for estimation
and forecasting.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">equations</span> <span class="op">&lt;-</span> <span class="st">"consumption ~ profits + profits.L(1) + total_wages,</span></span>
<span><span class="st">investment ~ profits + profits.L(1) + capital_stock.L(1),</span></span>
<span><span class="st">wages ~ gdp + gdp.L(1) + time_trend,</span></span>
<span><span class="st">gdp == (n_consumption/n_gdp)*consumption + (n_investment/n_gdp)*investment + (n_government/n_gdp)*government,</span></span>
<span><span class="st">profits == (n_gdp/n_profits)*gdp - (n_taxes/n_profits)*taxes - (n_wages/n_profits)*wages,</span></span>
<span><span class="st">capital_stock == 1.001*capital_stock.L(1) + 0.0002*investment,</span></span>
<span><span class="st">total_wages == (n_wages/n_total_wages)*wages + (n_government_wages/n_total_wages)*government_wages"</span></span>
<span></span>
<span><span class="va">exogenous_variables</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"government"</span>, <span class="st">"government_wages"</span>, <span class="st">"taxes"</span>, <span class="st">"time_trend"</span><span class="op">)</span></span></code></pre></div>
<p>The <code>equations</code> string contains the model equations, while
<code>exogenous_variables</code> lists the exogenous variables. The
<code>.L(1)</code> notation indicates a lag of one period. For further
details on the syntax, please refer to the <a href="../equations.html">equation syntax documentation</a>.</p>
</div>
<div class="section level2">
<h2 id="creating-the-sem">Creating the SEM<a class="anchor" aria-label="anchor" href="#creating-the-sem"></a>
</h2>
<p>The <code>system_of_equations</code> function is used to create a
system of equations object, which can then be used for estimation and
forecasting.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://timothymerlin.github.io/koma">koma</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">sys_eq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/system_of_equations.html">system_of_equations</a></span><span class="op">(</span></span>
<span>  equations <span class="op">=</span> <span class="va">equations</span>,</span>
<span>  exogenous_variables <span class="op">=</span> <span class="va">exogenous_variables</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sys_eq</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">System of Equations</span> <span style="color: #00BBBB;">─────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">##   <span style="font-weight: bold;">consumption</span> ~  constant + profits + profits.L(1) + total_wages</span></span>
<span><span class="co">##    <span style="font-weight: bold;">investment</span> ~  constant + profits + profits.L(1) + capital_stock.L(1)</span></span>
<span><span class="co">##         <span style="font-weight: bold;">wages</span> ~  constant + gdp + gdp.L(1) + time_trend</span></span>
<span><span class="co">##           <span style="font-weight: bold;">gdp</span> == (n_consumption/n_gdp) * consumption + (n_investment/n_gdp) * investment + (n_government/n_gdp) * government</span></span>
<span><span class="co">##       <span style="font-weight: bold;">profits</span> == (n_gdp/n_profits) * gdp-(n_taxes/n_profits) * taxes-(n_wages/n_profits) * wages</span></span>
<span><span class="co">## <span style="font-weight: bold;">capital_stock</span> == 1.001 * capital_stock.L(1) + 0.0002 * investment</span></span>
<span><span class="co">##   <span style="font-weight: bold;">total_wages</span> == (n_wages/n_total_wages) * wages + (n_government_wages/n_total_wages) * government_wages</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="defing-the-estimation-and-forecast-dates">Defing the Estimation and Forecast Dates<a class="anchor" aria-label="anchor" href="#defing-the-estimation-and-forecast-dates"></a>
</h2>
<p>Now, we need to specify the dates for estimation and forecasting.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  estimation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1990</span>, <span class="fl">1</span><span class="op">)</span>, end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2020</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  forecast <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2021</span>, <span class="fl">1</span><span class="op">)</span>, end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2023</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  dynamic_weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1990</span>, <span class="fl">1</span><span class="op">)</span>, end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2020</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="preparing-the-data">Preparing the Data<a class="anchor" aria-label="anchor" href="#preparing-the-data"></a>
</h2>
<p>We will use the <code>klein</code> dataset, which contains the
required variables for the model. This dataset is a list of standard
time series (<code>ts</code>) objects, where each object corresponds to
a variable in the model. You can explore the dataset by using the
<code><a href="../reference/klein.html">?klein</a></code> command to view its documentation and structure.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">klein</span></span></code></pre></div>
<p>To prepare the dataset for use with the <code>koma</code> package, we
need to convert the <code>ts</code> objects to the <code>ets</code>
format using the <code>as_ets</code> function.</p>
<p>The model is estimated in growth rates. The <code>klein</code>
dataset is in levels. We use the <code>ets</code> to tell the model that
the data is in levels and how to convert it to growth rates.
<code>ets</code> is generalized to accept any additional attributes.
Below we use this feature to save the series’ value_type (real or
nominal).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Some series in the klein dataset are nominal. We need to deflate them using the GDP deflator.</span></span>
<span><span class="va">klein</span><span class="op">$</span><span class="va">profits</span> <span class="op">&lt;-</span> <span class="va">klein</span><span class="op">$</span><span class="va">n_profits</span> <span class="op">/</span> <span class="op">(</span><span class="va">klein</span><span class="op">$</span><span class="va">d_gdp</span> <span class="op">/</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">klein</span><span class="op">$</span><span class="va">capital_stock</span> <span class="op">&lt;-</span> <span class="va">klein</span><span class="op">$</span><span class="va">n_capital_stock</span> <span class="op">/</span> <span class="op">(</span><span class="va">klein</span><span class="op">$</span><span class="va">d_gdp</span> <span class="op">/</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">klein</span><span class="op">$</span><span class="va">wages</span> <span class="op">&lt;-</span> <span class="va">klein</span><span class="op">$</span><span class="va">n_wages</span> <span class="op">/</span> <span class="op">(</span><span class="va">klein</span><span class="op">$</span><span class="va">d_gdp</span> <span class="op">/</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">klein</span><span class="op">$</span><span class="va">government_wages</span> <span class="op">&lt;-</span> <span class="va">klein</span><span class="op">$</span><span class="va">n_government_wages</span> <span class="op">/</span> <span class="op">(</span><span class="va">klein</span><span class="op">$</span><span class="va">d_gdp</span> <span class="op">/</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">klein</span><span class="op">$</span><span class="va">taxes</span> <span class="op">&lt;-</span> <span class="va">klein</span><span class="op">$</span><span class="va">n_taxes</span> <span class="op">/</span> <span class="op">(</span><span class="va">klein</span><span class="op">$</span><span class="va">d_gdp</span> <span class="op">/</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="va">real_series</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"gdp"</span>, <span class="st">"consumption"</span>, <span class="st">"investment"</span>, <span class="st">"profits"</span>, <span class="st">"capital_stock"</span>,</span>
<span>  <span class="st">"government"</span>, <span class="st">"wages"</span>, <span class="st">"government_wages"</span>, <span class="st">"taxes"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">real_ts_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">real_series</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/koma_ts.html">as_ets</a></span><span class="op">(</span><span class="va">klein</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    series_type <span class="op">=</span> <span class="st">"level"</span>, method <span class="op">=</span> <span class="st">"diff_log"</span>, value_type <span class="op">=</span> <span class="st">"real"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">real_ts_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">real_series</span></span>
<span></span>
<span><span class="va">real_ts_data</span><span class="op">$</span><span class="va">total_wages</span> <span class="op">&lt;-</span> <span class="va">real_ts_data</span><span class="op">$</span><span class="va">government_wages</span> <span class="op">+</span> <span class="va">real_ts_data</span><span class="op">$</span><span class="va">wages</span></span>
<span></span>
<span><span class="co"># net exports can be negative, we thus want to use percentage change instead of log difference</span></span>
<span><span class="va">real_ts_data</span><span class="op">$</span><span class="va">net_exports</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/koma_ts.html">as_ets</a></span><span class="op">(</span><span class="va">klein</span><span class="op">$</span><span class="va">net_exports</span>,</span>
<span>  series_type <span class="op">=</span> <span class="st">"level"</span>, method <span class="op">=</span> <span class="st">"percentage"</span>, value_type <span class="op">=</span> <span class="st">"real"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># To compute the weights in the model, we include the nominal series in the dataset as well.</span></span>
<span><span class="va">nominal_series</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"n_gdp"</span>, <span class="st">"n_investment"</span>, <span class="st">"n_government"</span>, <span class="st">"n_government_wages"</span>,</span>
<span>  <span class="st">"n_taxes"</span>, <span class="st">"n_profits"</span>, <span class="st">"n_wages"</span>, <span class="st">"n_consumption"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">nominal_ts_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">nominal_series</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/koma_ts.html">as_ets</a></span><span class="op">(</span><span class="va">klein</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    series_type <span class="op">=</span> <span class="st">"level"</span>, method <span class="op">=</span> <span class="st">"diff_log"</span>, value_type <span class="op">=</span> <span class="st">"nominal"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">nominal_ts_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">nominal_series</span></span>
<span></span>
<span><span class="va">nominal_ts_data</span><span class="op">$</span><span class="va">n_total_wages</span> <span class="op">&lt;-</span> <span class="va">nominal_ts_data</span><span class="op">$</span><span class="va">n_government_wages</span> <span class="op">+</span> <span class="va">nominal_ts_data</span><span class="op">$</span><span class="va">n_wages</span></span>
<span></span>
<span><span class="co"># Combining the real and nominal series</span></span>
<span><span class="va">ts_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">real_ts_data</span>, <span class="va">nominal_ts_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Adding the time trend</span></span>
<span><span class="va">ts_data</span><span class="op">$</span><span class="va">time_trend</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/koma_ts.html">ets</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">klein</span><span class="op">$</span><span class="va">taxes</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  start <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/start.html" class="external-link">start</a></span><span class="op">(</span><span class="va">ts_data</span><span class="op">$</span><span class="va">taxes</span><span class="op">)</span>, frequency <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  series_type <span class="op">=</span> <span class="st">"level"</span>, method <span class="op">=</span> <span class="st">"none"</span>, value_type <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>With the data prepared, we can now proceed to estimate the model.
Before forecasting, however, we need to truncate the endogenous
variables to ensure they only include data up to the forecast start
date.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ts_data</span><span class="op">[</span><span class="va">sys_eq</span><span class="op">$</span><span class="va">endogenous_variables</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">sys_eq</span><span class="op">$</span><span class="va">endogenous_variables</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/window.html" class="external-link">window</a></span><span class="op">(</span><span class="va">ts_data</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span>, end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2020</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="estimating-the-model">Estimating the Model<a class="anchor" aria-label="anchor" href="#estimating-the-model"></a>
</h2>
<p>The names of the list elements should match the variable names used
in the equations. Now, we can estimate the model using the
<code>estimate</code> function.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span></span>
<span>  <span class="va">sys_eq</span>,</span>
<span>  ts_data <span class="op">=</span> <span class="va">ts_data</span>,</span>
<span>  dates <span class="op">=</span> <span class="va">dates</span></span>
<span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Gibbs Sampler Settings</span> <span style="color: #00BBBB;">──────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## ── <span style="font-weight: bold;">System Wide Settings</span> ──</span></span>
<span><span class="co">## • Number of draws (`ndraws`): 2000</span></span>
<span><span class="co">## • Burn-in ratio (`burnin_ratio`): 0.5</span></span>
<span><span class="co">## • Burn-in (`burnin`): 1000</span></span>
<span><span class="co">## • Store frequency (`nstore`): 1</span></span>
<span><span class="co">## • Number of saved draws (`nsave`): 1000</span></span>
<span><span class="co">## • Tau (`tau`): 1.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Estimation</span> <span style="color: #00BBBB;">──────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Estimates</span> <span style="color: #00BBBB;">───────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">##   <span style="font-weight: bold;">consumption</span> ~  - 0.12  +  0.13 * profits - 0.03 * profits.L(1)  +  1.11 * total_wages</span></span>
<span><span class="co">##    <span style="font-weight: bold;">investment</span> ~  - 0.86  +  0.39 * profits  +  0.16 * profits.L(1)  +  1.51 * capital_stock.L(1)</span></span>
<span><span class="co">##         <span style="font-weight: bold;">wages</span> ~  - 0.68  +  0.95 * gdp  +  0.43 * gdp.L(1)  +  0 * time_trend</span></span>
<span><span class="co">##           <span style="font-weight: bold;">gdp</span> == (n_consumption/n_gdp) * consumption  +  (n_investment/n_gdp) * investment  +  (n_government/n_gdp) * government</span></span>
<span><span class="co">##       <span style="font-weight: bold;">profits</span> == (n_gdp/n_profits) * gdp - (n_taxes/n_profits) * taxes - (n_wages/n_profits) * wages</span></span>
<span><span class="co">## <span style="font-weight: bold;">capital_stock</span> == 1.001 * capital_stock.L(1)  +  0.0002 * investment</span></span>
<span><span class="co">##   <span style="font-weight: bold;">total_wages</span> == (n_wages/n_total_wages) * wages  +  (n_government_wages/n_total_wages) * government_wages</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## =================================================================</span></span>
<span><span class="co">##                     consumption     investment     wages         </span></span>
<span><span class="co">## -----------------------------------------------------------------</span></span>
<span><span class="co">## constant             -0.12           -0.86          -0.68        </span></span>
<span><span class="co">##                     [-0.31;  0.08]  [-1.84; 0.02]  [-1.34; -0.06]</span></span>
<span><span class="co">## profits.L(1)         -0.03            0.16                       </span></span>
<span><span class="co">##                     [-0.05; -0.00]  [ 0.07; 0.24]                </span></span>
<span><span class="co">## profits               0.13            0.39                       </span></span>
<span><span class="co">##                     [ 0.10;  0.16]  [ 0.21; 0.57]                </span></span>
<span><span class="co">## total_wages           1.11                                       </span></span>
<span><span class="co">##                     [ 0.97;  1.25]                               </span></span>
<span><span class="co">## capital_stock.L(1)                    1.51                       </span></span>
<span><span class="co">##                                     [ 0.41; 2.54]                </span></span>
<span><span class="co">## gdp.L(1)                                             0.43        </span></span>
<span><span class="co">##                                                    [ 0.30;  0.56]</span></span>
<span><span class="co">## time_trend                                           0.00        </span></span>
<span><span class="co">##                                                    [-0.00;  0.01]</span></span>
<span><span class="co">## gdp                                                  0.95        </span></span>
<span><span class="co">##                                                    [ 0.80;  1.10]</span></span>
<span><span class="co">## =================================================================</span></span>
<span><span class="co">## Posterior mean (90% credible interval: [5.0%, 95.0%])</span></span>
<span><span class="co">## Estimation period: 1990 Q1 - 2020 Q4</span></span></code></pre></div>
<p>To see how to run the estimation in parallel, refer to the <a href="../parallel.html">parallel estimation vignette</a>.</p>
</div>
<div class="section level2">
<h2 id="forecasting">Forecasting<a class="anchor" aria-label="anchor" href="#forecasting"></a>
</h2>
<p>To forecast the model, we can use the <code>forecast</code> function.
This function will generate forecasts for the specified date range.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">forecasts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/forecast.html">forecast</a></span><span class="op">(</span></span>
<span>  <span class="va">estimates</span>,</span>
<span>  dates <span class="op">=</span> <span class="va">dates</span></span>
<span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Forecast</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">forecasts</span><span class="op">)</span></span>
<span><span class="co">##         consumption investment   wages     gdp profits capital_stock</span></span>
<span><span class="co">## 2021 Q1     -1.5696    -0.9364 -0.4585 -0.9971 -8.6728        2.5034</span></span>
<span><span class="co">## 2021 Q2     -0.3184     2.0125 -0.4641 -0.0393  0.5787        2.5063</span></span>
<span><span class="co">## 2021 Q3     -1.4778     1.1015 -0.8382 -0.8595 -5.7589        2.5091</span></span>
<span><span class="co">## 2021 Q4     -0.9760     1.8101 -0.7312 -0.3394 -1.1363        2.5119</span></span>
<span><span class="co">## 2022 Q1     -0.8366     2.3480 -0.4170 -0.2863 -1.6901        2.5149</span></span>
<span><span class="co">## 2022 Q2     -0.9388     2.0577 -0.4517 -0.3232 -1.5241        2.5178</span></span>
<span><span class="co">## 2022 Q3     -1.8300     0.3312 -1.1432 -1.0985 -6.6025        2.5204</span></span>
<span><span class="co">## 2022 Q4     -2.1483    -0.0936 -1.6466 -1.2243 -5.9269        2.5229</span></span>
<span><span class="co">## 2023 Q1     -2.3428    -0.3106 -1.8222 -1.4085 -7.1482        2.5254</span></span>
<span><span class="co">## 2023 Q2     -1.7959     0.0577 -1.5161 -1.0662 -5.0824        2.5279</span></span>
<span><span class="co">## 2023 Q3     -2.4004    -0.4895 -1.8163 -1.4545 -7.9550        2.5303</span></span>
<span><span class="co">## 2023 Q4     -1.9098    -0.3149 -1.6764 -1.1801 -5.6997        2.5328</span></span>
<span><span class="co">##         total_wages government government_wages   taxes time_trend</span></span>
<span><span class="co">## 2021 Q1     -0.4802     1.2758          -0.5982  0.8997        205</span></span>
<span><span class="co">## 2021 Q2     -0.4267    -1.0791          -0.2234  9.1809        206</span></span>
<span><span class="co">## 2021 Q3     -0.5756    -0.3873           0.8500  0.3182        207</span></span>
<span><span class="co">## 2021 Q4     -0.7725    -0.0708          -0.9966  4.6251        208</span></span>
<span><span class="co">## 2022 Q1     -0.4884    -0.8533          -0.8763  3.5975        209</span></span>
<span><span class="co">## 2022 Q2     -0.5961    -0.3752          -1.3801 -1.3602        210</span></span>
<span><span class="co">## 2022 Q3     -0.8943     0.3883           0.4571 -5.3551        211</span></span>
<span><span class="co">## 2022 Q4     -1.2981     1.3228           0.5938 -6.2183        212</span></span>
<span><span class="co">## 2023 Q1     -1.4128     1.2402           0.8097 -6.4787        213</span></span>
<span><span class="co">## 2023 Q2     -1.1329     0.7229           0.9474 -2.6579        214</span></span>
<span><span class="co">## 2023 Q3     -1.3031     1.3819           1.4833 -2.8205        215</span></span>
<span><span class="co">## 2023 Q4     -1.2141     0.8931           1.2959 -2.1251        216</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">forecasts</span>, variables <span class="op">=</span> <span class="st">"gdp"</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Samad Sarferaz, Laurent Florin, Merlin Scherer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
