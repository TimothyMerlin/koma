<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Error Correction in a Small Open Economy Model • koma</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Error Correction in a Small Open Economy Model">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">koma</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/timothymerlin/koma" aria-label="koma on GitHub"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Error Correction in a Small Open Economy Model</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/timothymerlin/koma/blob/0.2.1/vignettes/koma-error-correction.Rmd" class="external-link"><code>vignettes/koma-error-correction.Rmd</code></a></small>
      <div class="d-none name"><code>koma-error-correction.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://timothymerlin.github.io/koma">koma</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>When a set of variables is cointegrated—meaning they share a common
long-run stochastic trend—short-run dynamics can be represented using an
error-correction model (ECM). An ECM decomposes movements into short-run
adjustments and a long-run equilibrium relationship, with deviations
from the equilibrium feeding back into short-run growth through an
error-correction term. For background, see <a href="https://en.wikipedia.org/wiki/Error_correction_model" class="external-link uri">https://en.wikipedia.org/wiki/Error_correction_model</a>.</p>
<p>In this vignette, we specify a small structural system that includes
an ECM for exports. We then construct the required level variables,
prepare the data, and estimate the model.</p>
<div class="section level3">
<h3 id="export-ecm-intuition">Export ECM Intuition<a class="anchor" aria-label="anchor" href="#export-ecm-intuition"></a>
</h3>
<p>We omit contemporaneous exchange-rate growth in the short-run
dynamics, assuming exports do not respond to very short-run
exchange-rate movements in this vignette.</p>
<p>The export equation is motivated by a standard export-demand
relationship. In the long run, export volumes depend on foreign demand,
proxied by world GDP, and on relative prices or international
competitiveness, proxied by the exchange rate. If exports, world GDP,
and the exchange rate are cointegrated, their long-run relationship can
be written in levels.</p>
<p>Short-run export growth is then modeled as a function of current
changes in foreign demand, together with an error-correction term that
captures the deviation from the long-run equilibrium in the previous
period. The coefficient on this term measures the speed at which exports
adjust back toward the long-run relationship following a shock.</p>
<p>If exports
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>t</mi></msub><annotation encoding="application/x-tex">x_t</annotation></semantics></math>,
world GDP
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mi>t</mi></msub><annotation encoding="application/x-tex">y_t</annotation></semantics></math>,
and the exchange rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>q</mi><mi>t</mi></msub><annotation encoding="application/x-tex">q_t</annotation></semantics></math>
are cointegrated, the long-run equilibrium relationship can be written
as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub><mo>=</mo><mi>α</mi><mo>+</mo><msub><mi>β</mi><mi>y</mi></msub><msub><mi>y</mi><mi>t</mi></msub><mo>+</mo><msub><mi>β</mi><mi>q</mi></msub><msub><mi>q</mi><mi>t</mi></msub><mo>+</mo><msub><mi>u</mi><mi>t</mi></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">
x_t = \alpha + \beta_y y_t + \beta_q q_t + u_t .
</annotation></semantics></math></p>
<p>The deviation from this equilibrium in the previous period defines
the error-correction term,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi mathvariant="normal">E</mi><mi mathvariant="normal">C</mi><mi mathvariant="normal">T</mi></mrow><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>−</mo><mi>α</mi><mo>−</mo><msub><mi>β</mi><mi>y</mi></msub><msub><mi>y</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>β</mi><mi>q</mi></msub><msub><mi>q</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">
\mathrm{ECT}_{t-1}
= x_{t-1} - \alpha - \beta_y y_{t-1} - \beta_q q_{t-1} .
</annotation></semantics></math></p>
<p>A minimal one-lag ECM for export growth is then
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><msub><mi>x</mi><mi>t</mi></msub><mo>=</mo><mi>γ</mi><mo>+</mo><mi>ϕ</mi><mspace width="0.167em"></mspace><mi>Δ</mi><msub><mi>x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>θ</mi><mspace width="0.167em"></mspace><mi>Δ</mi><msub><mi>y</mi><mi>t</mi></msub><mo>+</mo><mi>λ</mi><mspace width="0.167em"></mspace><msub><mrow><mi mathvariant="normal">E</mi><mi mathvariant="normal">C</mi><mi mathvariant="normal">T</mi></mrow><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>ε</mi><mi>t</mi></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">
\Delta x_t
= \gamma
+ \phi\,\Delta x_{t-1}
+ \theta\,\Delta y_t
+ \lambda\,\mathrm{ECT}_{t-1}
+ \varepsilon_t .
</annotation></semantics></math></p>
<p>Substituting the error-correction term into the ECM and expanding
yields
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>Δ</mi><msub><mi>x</mi><mi>t</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>γ</mi><mo>+</mo><mi>ϕ</mi><mspace width="0.167em"></mspace><mi>Δ</mi><msub><mi>x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>θ</mi><mspace width="0.167em"></mspace><mi>Δ</mi><msub><mi>y</mi><mi>t</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mspace width="1.0em"></mspace><mo>+</mo><mi>λ</mi><msub><mi>x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>−</mo><mi>λ</mi><mi>α</mi><mo>−</mo><mi>λ</mi><msub><mi>β</mi><mi>y</mi></msub><msub><mi>y</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>−</mo><mi>λ</mi><msub><mi>β</mi><mi>q</mi></msub><msub><mi>q</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>ε</mi><mi>t</mi></msub><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
\Delta x_t
&amp;= \gamma
+ \phi\,\Delta x_{t-1}
+ \theta\,\Delta y_t \\
&amp;\quad
+ \lambda x_{t-1}
- \lambda\alpha
- \lambda\beta_y y_{t-1}
- \lambda\beta_q q_{t-1}
+ \varepsilon_t .
\end{aligned}
</annotation></semantics></math></p>
<p>This is the form estimated in the model, where lagged levels enter
directly. The coefficient
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
is the speed of adjustment toward the long-run equilibrium.</p>
<p>The long-run coefficients are recovered as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mi>y</mi></msub><mo>=</mo><mo>−</mo><mfrac><mrow><mtext mathvariant="normal">coef</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mi>λ</mi></mfrac><mo>,</mo><mspace width="2.0em"></mspace><msub><mi>β</mi><mi>q</mi></msub><mo>=</mo><mo>−</mo><mfrac><mrow><mtext mathvariant="normal">coef</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>q</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mi>λ</mi></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
\beta_y = -\frac{\text{coef}(y_{t-1})}{\lambda},
\qquad
\beta_q = -\frac{\text{coef}(q_{t-1})}{\lambda}.
</annotation></semantics></math></p>
</div>
</div>
<div class="section level2">
<h2 id="define-the-sem">Define the SEM<a class="anchor" aria-label="anchor" href="#define-the-sem"></a>
</h2>
<p>We now translate the error-correction representation into a
structural system that can be estimated directly. Rather than including
the error-correction term explicitly, the model is written with lagged
level variables. This formulation is algebraically equivalent to the ECM
expansion above and allows the speed-of-adjustment and long-run
relationships to be recovered from the estimated coefficients.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">equations</span> <span class="op">&lt;-</span> <span class="st">"consumption ~ gdp + consumption.L(1),</span></span>
<span><span class="st">investment ~ investment.L(1),</span></span>
<span><span class="st">exports ~ world_gdp + exports.L(1) + exports_level.L(1) + world_gdp_level.L(1) + exchange_rate_level.L(1),</span></span>
<span><span class="st">imports ~ exports + consumption + investment + imports.L(1),</span></span>
<span><span class="st">gdp == 0.6*consumption + 0.6*domestic_demand + 0.5*exports - 0.4*imports,</span></span>
<span><span class="st">domestic_demand == 0.6*consumption + 0.4*investment,</span></span>
<span><span class="st">exports_level == 1*exports + 1*exports_level.L(1),</span></span>
<span><span class="st">world_gdp_level == 1*world_gdp + 1*world_gdp_level.L(1),</span></span>
<span><span class="st">exchange_rate_level == 1*exchange_rate + 1*exchange_rate_level.L(1)"</span></span>
<span></span>
<span><span class="va">exogenous_variables</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"world_gdp"</span>, <span class="st">"exchange_rate"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="create-the-sem">Create the SEM<a class="anchor" aria-label="anchor" href="#create-the-sem"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sys_eq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/system_of_equations.html">system_of_equations</a></span><span class="op">(</span></span>
<span>    equations <span class="op">=</span> <span class="va">equations</span>,</span>
<span>    exogenous_variables <span class="op">=</span> <span class="va">exogenous_variables</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sys_eq</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">System of Equations</span> <span style="color: #00BBBB;">─────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt;         <span style="font-weight: bold;">consumption</span> ~  constant + gdp + consumption.L(1)</span></span>
<span><span class="co">#&gt;          <span style="font-weight: bold;">investment</span> ~  constant + investment.L(1)</span></span>
<span><span class="co">#&gt;             <span style="font-weight: bold;">exports</span> ~  constant + world_gdp + exports.L(1) + exports_level.L(1) + world_gdp_level.L(1) + exchange_rate_level.L(1)</span></span>
<span><span class="co">#&gt;             <span style="font-weight: bold;">imports</span> ~  constant + exports + consumption + investment + imports.L(1)</span></span>
<span><span class="co">#&gt;                 <span style="font-weight: bold;">gdp</span> == 0.6 * consumption + 0.6 * domestic_demand + 0.5 * exports-0.4 * imports</span></span>
<span><span class="co">#&gt;     <span style="font-weight: bold;">domestic_demand</span> == 0.6 * consumption + 0.4 * investment</span></span>
<span><span class="co">#&gt;       <span style="font-weight: bold;">exports_level</span> == 1 * exports + 1 * exports_level.L(1)</span></span>
<span><span class="co">#&gt;     <span style="font-weight: bold;">world_gdp_level</span> == 1 * world_gdp + 1 * world_gdp_level.L(1)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">exchange_rate_level</span> == 1 * exchange_rate + 1 * exchange_rate_level.L(1)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="preparing-the-data">Preparing the Data<a class="anchor" aria-label="anchor" href="#preparing-the-data"></a>
</h2>
<p><code>koma</code> is estimated in growth rates, so error correction
terms need to enter in levels. We create level terms as
<code>series_type = "level"</code> with <code>method = "none"</code> so
<code><a href="../reference/rate.html">rate()</a></code> leaves them unchanged during estimation.</p>
<p>We use <code>small_open_economy</code>, which provides the needed
series in levels.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">small_open_economy</span></span></code></pre></div>
<p>Convert the base series to <code>ets</code> objects first, then add
the level terms for error correction. Adding the level terms after the
base conversion avoids overwriting them when the list is rebuilt.</p>
<p>We take logs to make the long-run relationship linear in levels and
to match the <code>diff_log</code> transformation used for growth rates.
Multiplying by 100 keeps the level terms on the same scale as
<code>diff_log</code>, which also returns percent changes.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ts_data</span> <span class="op">&lt;-</span> <span class="va">small_open_economy</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"consumption"</span>, <span class="st">"investment"</span>, <span class="st">"exports"</span>, <span class="st">"imports"</span>,</span>
<span>    <span class="st">"gdp"</span>, <span class="st">"domestic_demand"</span>, <span class="st">"world_gdp"</span>, <span class="st">"exchange_rate"</span></span>
<span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">series</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ts_data</span><span class="op">)</span></span>
<span><span class="va">ts_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">series</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/koma_ts.html">as_ets</a></span><span class="op">(</span><span class="va">ts_data</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span>,</span>
<span>        series_type <span class="op">=</span> <span class="st">"level"</span>, method <span class="op">=</span> <span class="st">"diff_log"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ts_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">series</span></span>
<span></span>
<span><span class="va">ts_data</span><span class="op">$</span><span class="va">exports_level</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/koma_ts.html">as_ets</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">ts_data</span><span class="op">$</span><span class="va">exports</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>    series_type <span class="op">=</span> <span class="st">"level"</span>, method <span class="op">=</span> <span class="st">"none"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ts_data</span><span class="op">$</span><span class="va">world_gdp_level</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/koma_ts.html">as_ets</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">ts_data</span><span class="op">$</span><span class="va">world_gdp</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>    series_type <span class="op">=</span> <span class="st">"level"</span>, method <span class="op">=</span> <span class="st">"none"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ts_data</span><span class="op">$</span><span class="va">exchange_rate_level</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/koma_ts.html">as_ets</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">ts_data</span><span class="op">$</span><span class="va">exchange_rate</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>    series_type <span class="op">=</span> <span class="st">"level"</span>, method <span class="op">=</span> <span class="st">"none"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="estimation-and-forecast-dates">Estimation and Forecast Dates<a class="anchor" aria-label="anchor" href="#estimation-and-forecast-dates"></a>
</h2>
<p>With the data prepared, define the estimation and forecast
windows.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    estimation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1996</span>, <span class="fl">1</span><span class="op">)</span>, end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2019</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    forecast <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2023</span>, <span class="fl">1</span><span class="op">)</span>, end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2024</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="estimating-the-model">Estimating the Model<a class="anchor" aria-label="anchor" href="#estimating-the-model"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span></span>
<span>    <span class="va">sys_eq</span>,</span>
<span>    ts_data <span class="op">=</span> <span class="va">ts_data</span>,</span>
<span>    dates <span class="op">=</span> <span class="va">dates</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Gibbs Sampler Settings</span> <span style="color: #00BBBB;">──────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">System Wide Settings</span> ──</span></span>
<span><span class="co">#&gt; • Number of draws (`ndraws`): 2000</span></span>
<span><span class="co">#&gt; • Burn-in ratio (`burnin_ratio`): 0.5</span></span>
<span><span class="co">#&gt; • Burn-in (`burnin`): 1000</span></span>
<span><span class="co">#&gt; • Store frequency (`nstore`): 1</span></span>
<span><span class="co">#&gt; • Number of saved draws (`nsave`): 1000</span></span>
<span><span class="co">#&gt; • Tau (`tau`): 1.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Estimation</span> <span style="color: #00BBBB;">──────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Estimates</span> <span style="color: #00BBBB;">───────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt;         <span style="font-weight: bold;">consumption</span> ~  0.35 - 0.01 * gdp  +  0.1 * consumption.L(1)</span></span>
<span><span class="co">#&gt;          <span style="font-weight: bold;">investment</span> ~  0.45  +  0.21 * investment.L(1)</span></span>
<span><span class="co">#&gt;             <span style="font-weight: bold;">exports</span> ~  - 1083.18  +  2.87 * world_gdp - 0.19 * exports.L(1) - 0.24 * exports_level.L(1)  +  0.55 * world_gdp_level.L(1)  +  0.06 * exchange_rate_level.L(1)</span></span>
<span><span class="co">#&gt;             <span style="font-weight: bold;">imports</span> ~  - 0.01 - 0.01 * exports  +  1.51 * consumption  +  0.98 * investment - 0.13 * imports.L(1)</span></span>
<span><span class="co">#&gt;                 <span style="font-weight: bold;">gdp</span> == 0.6 * consumption  +  0.6 * domestic_demand  +  0.5 * exports - 0.4 * imports</span></span>
<span><span class="co">#&gt;     <span style="font-weight: bold;">domestic_demand</span> == 0.6 * consumption  +  0.4 * investment</span></span>
<span><span class="co">#&gt;       <span style="font-weight: bold;">exports_level</span> == 1 * exports  +  1 * exports_level.L(1)</span></span>
<span><span class="co">#&gt;     <span style="font-weight: bold;">world_gdp_level</span> == 1 * world_gdp  +  1 * world_gdp_level.L(1)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">exchange_rate_level</span> == 1 * exchange_rate  +  1 * exchange_rate_level.L(1)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">estimates</span>, variables <span class="op">=</span> <span class="st">"exports"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; =============================================</span></span>
<span><span class="co">#&gt;                           exports            </span></span>
<span><span class="co">#&gt; ---------------------------------------------</span></span>
<span><span class="co">#&gt; constant                   -1083.18          </span></span>
<span><span class="co">#&gt;                           [-1643.61; -529.64]</span></span>
<span><span class="co">#&gt; exports.L(1)                  -0.19          </span></span>
<span><span class="co">#&gt;                           [   -0.37;   -0.01]</span></span>
<span><span class="co">#&gt; exports_level.L(1)            -0.24          </span></span>
<span><span class="co">#&gt;                           [   -0.37;   -0.12]</span></span>
<span><span class="co">#&gt; world_gdp_level.L(1)           0.55          </span></span>
<span><span class="co">#&gt;                           [    0.27;    0.84]</span></span>
<span><span class="co">#&gt; exchange_rate_level.L(1)       0.06          </span></span>
<span><span class="co">#&gt;                           [    0.01;    0.11]</span></span>
<span><span class="co">#&gt; world_gdp                      2.87          </span></span>
<span><span class="co">#&gt;                           [    1.93;    3.76]</span></span>
<span><span class="co">#&gt; =============================================</span></span>
<span><span class="co">#&gt; Posterior mean (90% credible interval: [5.0%, 95.0%])</span></span>
<span><span class="co">#&gt; Estimation period: 1996 Q1 - 2019 Q4</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ecm_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">estimates</span>, variables <span class="op">=</span> <span class="st">"exports"</span><span class="op">)</span></span>
<span><span class="va">ecm_coef</span> <span class="op">&lt;-</span> <span class="va">ecm_stats</span><span class="op">[[</span><span class="st">"exports"</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">coef</span></span>
<span><span class="va">adjustment_speed</span> <span class="op">&lt;-</span> <span class="va">ecm_coef</span><span class="op">[</span><span class="st">"exports_level.L(1)"</span><span class="op">]</span></span>
<span><span class="va">long_run_world_gdp</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">ecm_coef</span><span class="op">[</span><span class="st">"world_gdp_level.L(1)"</span><span class="op">]</span> <span class="op">/</span> <span class="va">adjustment_speed</span></span>
<span><span class="va">long_run_exchange_rate</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">ecm_coef</span><span class="op">[</span><span class="st">"exchange_rate_level.L(1)"</span><span class="op">]</span> <span class="op">/</span> <span class="va">adjustment_speed</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span></span>
<span>    <span class="st">"Adjustment speed: %.3f, Long-run world GDP: %.3f, Exchange rate: %.3f"</span>,</span>
<span>    <span class="va">adjustment_speed</span>,</span>
<span>    <span class="va">long_run_world_gdp</span>,</span>
<span>    <span class="va">long_run_exchange_rate</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Adjustment speed: -0.242, Long-run world GDP: 2.285, Exchange rate: 0.247"</span></span></code></pre></div>
<p>The adjustment speed is -0.24, which is negative and implies about
24% of the gap closes each period. The long-run elasticities imply that
a 1% rise in world GDP is associated with roughly 2.28% higher exports
in the long run, while a 1% increase in the exchange-rate index implies
0.25% higher exports if higher values indicate depreciation (here the
exchange rate is CHF/EUR, so higher values mean depreciation; flip the
sign if the index is defined the other way).</p>
</div>
<div class="section level2">
<h2 id="forecasting">Forecasting<a class="anchor" aria-label="anchor" href="#forecasting"></a>
</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estimates</span><span class="op">$</span><span class="va">ts_data</span><span class="op">[</span><span class="va">sys_eq</span><span class="op">$</span><span class="va">endogenous_variables</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">sys_eq</span><span class="op">$</span><span class="va">endogenous_variables</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/window.html" class="external-link">window</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">$</span><span class="va">ts_data</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span>, end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2022</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">forecasts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/forecast.html">forecast</a></span><span class="op">(</span></span>
<span>    <span class="va">estimates</span>,</span>
<span>    dates <span class="op">=</span> <span class="va">dates</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Forecast</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">forecasts</span><span class="op">)</span></span>
<span><span class="co">#&gt;         consumption investment exports imports    gdp domestic_demand</span></span>
<span><span class="co">#&gt; 2023 Q1      0.3747     0.3695  0.8578  1.0266 0.4666          0.3726</span></span>
<span><span class="co">#&gt; 2023 Q2      0.3810     0.4639  0.7363  0.7798 0.5333          0.4141</span></span>
<span><span class="co">#&gt; 2023 Q3      0.3714     0.5915  0.6504  0.9925 0.4267          0.4594</span></span>
<span><span class="co">#&gt; 2023 Q4      0.3995     0.5453  0.2972  0.9804 0.2708          0.4578</span></span>
<span><span class="co">#&gt; 2024 Q1      0.3907     0.5046  0.8627  0.8809 0.5751          0.4362</span></span>
<span><span class="co">#&gt; 2024 Q2      0.3899     0.4520  0.6635  0.8540 0.4729          0.4147</span></span>
<span><span class="co">#&gt; 2024 Q3      0.3862     0.5442  1.3581  0.9590 0.7968          0.4494</span></span>
<span><span class="co">#&gt; 2024 Q4      0.4007     0.5277  0.5356  1.1307 0.3268          0.4515</span></span>
<span><span class="co">#&gt;         exports_level world_gdp_level exchange_rate_level world_gdp</span></span>
<span><span class="co">#&gt; 2023 Q1      1168.954        2474.282             -0.7646    0.4827</span></span>
<span><span class="co">#&gt; 2023 Q2      1169.690        2474.690             -2.1510    0.4083</span></span>
<span><span class="co">#&gt; 2023 Q3      1170.340        2475.116             -3.9379    0.4259</span></span>
<span><span class="co">#&gt; 2023 Q4      1170.637        2475.407             -4.6881    0.2906</span></span>
<span><span class="co">#&gt; 2024 Q1      1171.500        2475.865             -5.2093    0.4586</span></span>
<span><span class="co">#&gt; 2024 Q2      1172.164        2476.261             -2.6797    0.3955</span></span>
<span><span class="co">#&gt; 2024 Q3      1173.522        2476.770             -4.9959    0.5096</span></span>
<span><span class="co">#&gt; 2024 Q4      1174.057        2477.210             -6.6168    0.4393</span></span>
<span><span class="co">#&gt;         exchange_rate</span></span>
<span><span class="co">#&gt; 2023 Q1        0.9217</span></span>
<span><span class="co">#&gt; 2023 Q2       -1.3863</span></span>
<span><span class="co">#&gt; 2023 Q3       -1.7869</span></span>
<span><span class="co">#&gt; 2023 Q4       -0.7502</span></span>
<span><span class="co">#&gt; 2024 Q1       -0.5212</span></span>
<span><span class="co">#&gt; 2024 Q2        2.5295</span></span>
<span><span class="co">#&gt; 2024 Q3       -2.3162</span></span>
<span><span class="co">#&gt; 2024 Q4       -1.6209</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rate.html">rate</a></span><span class="op">(</span><span class="va">forecasts</span><span class="op">$</span><span class="va">mean</span><span class="op">$</span><span class="va">exports</span><span class="op">)</span></span>
<span><span class="co">#&gt; rate, diff_log, c(118297.572909318, 2022.75)</span></span>
<span><span class="co">#&gt;           Qtr1      Qtr2      Qtr3      Qtr4</span></span>
<span><span class="co">#&gt; 2023 0.8577540 0.7362662 0.6503629 0.2972050</span></span>
<span><span class="co">#&gt; 2024 0.8627210 0.6635003 1.3581153 0.5355779</span></span>
<span><span class="fu"><a href="../reference/level.html">level</a></span><span class="op">(</span><span class="va">forecasts</span><span class="op">$</span><span class="va">mean</span><span class="op">$</span><span class="va">exports</span><span class="op">)</span></span>
<span><span class="co">#&gt; level, diff_log</span></span>
<span><span class="co">#&gt;          Qtr1     Qtr2     Qtr3     Qtr4</span></span>
<span><span class="co">#&gt; 2022                            118297.6</span></span>
<span><span class="co">#&gt; 2023 119316.6 120198.4 120982.6 121342.7</span></span>
<span><span class="co">#&gt; 2024 122394.1 123208.9 124893.6 125564.3</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Samad Sarferaz, Laurent Florin, Merlin Scherer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
