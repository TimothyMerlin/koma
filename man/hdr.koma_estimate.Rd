% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hdr.R
\name{hdr.koma_estimate}
\alias{hdr.koma_estimate}
\title{Highest Density Regions for koma_estimate Objects}
\usage{
\method{hdr}{koma_estimate}(
  x,
  variables = NULL,
  probs = c(0.5, 0.99),
  n_grid = 4096,
  integration = c("monte_carlo", "grid"),
  mc_use_observed = FALSE,
  mc_draws = NULL,
  mc_quantile_type = 7,
  bw = "nrd0",
  adjust = 1,
  kernel = "gaussian",
  include_sigma = FALSE,
  ...
)
}
\arguments{
\item{x}{A \code{koma_estimate} object.}

\item{variables}{Optional character vector of endogenous variables to
include. Defaults to all variables in \code{object$estimates}.}

\item{probs}{Numeric vector of target mass levels. Values in \eqn{(0, 1]}
or \eqn{[0, 100]} are accepted. Default is \code{c(0.5, 0.99)}.}

\item{n_grid}{Number of grid points for the KDE. Default is 4096.}

\item{integration}{Integration approach for the HDR cutoff. Use \code{"grid"}
for grid-based integration or \code{"monte_carlo"} for Monte Carlo integration.
Default is \code{"monte_carlo"}.}

\item{mc_use_observed}{Logical. If TRUE, Monte Carlo integration uses the
observed draws. This can be a reasonable approximation for large \code{x}.
If FALSE, draws are sampled from the KDE mixture; only implemented for
\code{kernel = "gaussian"}.}

\item{mc_draws}{Optional integer number of draws for Monte Carlo sampling
when \code{mc_use_observed = FALSE}. Defaults to \code{max(length(x), 2000)}.}

\item{mc_quantile_type}{Quantile type passed to \code{stats::quantile} for the
Monte Carlo cutoff. Type 1 matches the order-statistic construction in
Hyndman (1996), while type 7 (the default) interpolates between adjacent
order statistics for a smoother, lower-variance cutoff that is
asymptotically equivalent. Default is 7.}

\item{bw}{Bandwidth for \code{\link[stats]{density}}. Default is "nrd0".}

\item{adjust}{Bandwidth adjustment factor for
\code{\link[stats]{density}}. Default is 1.}

\item{kernel}{Kernel for \code{\link[stats]{density}}. Default is "gaussian".}

\item{include_sigma}{Logical. If TRUE, compute HDRs for the error variance
parameter (omega). Default is FALSE.}

\item{...}{Additional arguments forwarded to \code{\link[stats]{density}}.}
}
\value{
A list with class \code{c("koma_estimate_hdr", "koma_hdr")}
containing HDR intervals per coefficient. The object also includes an
\code{outliers} list with draws outside the largest HDR level.
}
\description{
Computes highest density regions (HDRs) for coefficient draws from a
\code{koma_estimate} object.
}
