% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hdr.R
\name{hdr}
\alias{hdr}
\alias{hdr.default}
\title{Highest Density Regions from a Kernel Density Estimate}
\usage{
hdr(x, ...)

\method{hdr}{default}(
  x,
  probs = c(0.5, 0.99),
  n_grid = 4096,
  integration = c("monte_carlo", "grid"),
  mc_use_observed = FALSE,
  mc_draws = NULL,
  mc_quantile_type = 7,
  bw = "nrd0",
  adjust = 1,
  kernel = "gaussian",
  ...
)
}
\arguments{
\item{x}{A numeric vector of draws.}

\item{...}{Additional arguments forwarded to
\code{\link[stats]{density}}. Do not pass \code{n}, \code{bw},
\code{adjust}, or \code{kernel} here.}

\item{probs}{Numeric vector of target mass levels. Values in \eqn{(0, 1]}
or \eqn{[0, 100]} are accepted. Default is \code{c(0.5, 0.99)}.}

\item{n_grid}{Number of grid points for the KDE. Default is 4096.}

\item{integration}{Integration approach for the HDR cutoff. Use \code{"grid"}
for grid-based integration or \code{"monte_carlo"} for Monte Carlo integration.
Default is \code{"monte_carlo"}.}

\item{mc_use_observed}{Logical. If TRUE, Monte Carlo integration uses the
observed draws. This can be a reasonable approximation for large \code{x}.
If FALSE, draws are sampled from the KDE mixture; only implemented for
\code{kernel = "gaussian"}.}

\item{mc_draws}{Optional integer number of draws for Monte Carlo sampling
when \code{mc_use_observed = FALSE}. Defaults to \code{max(length(x), 2000)}.}

\item{mc_quantile_type}{Quantile type passed to \code{stats::quantile} for the
Monte Carlo cutoff. Type 1 matches the order-statistic construction in
Hyndman (1996), while type 7 (the default) interpolates between adjacent
order statistics for a smoother, lower-variance cutoff that is
asymptotically equivalent. Default is 7.}

\item{bw}{Bandwidth for \code{\link[stats]{density}}. Default is "nrd0".}

\item{adjust}{Bandwidth adjustment factor for
\code{\link[stats]{density}}. Default is 1.}

\item{kernel}{Kernel for \code{\link[stats]{density}}. Default is "gaussian".}
}
\value{
A list with class \code{"koma_hdr"} containing:
\describe{
\item{intervals}{Named list of matrices with columns \code{lower} and
\code{upper}, one matrix per \code{probs} level.}
\item{mode}{Location of the KDE mode.}
\item{density}{The density object returned by \code{stats::density}.}
\item{cutoff}{Named numeric vector of density cutoffs for each level.}
\item{mass}{Named numeric vector of achieved mass for each level.
For \code{integration = "grid"}, this is the area under the KDE above the
cutoff (grid-based). For \code{integration = "monte_carlo"}, this is the
Monte Carlo coverage, i.e. the fraction of sampled points with
density above the cutoff.}
\item{probs}{Numeric vector of target masses in (0, 1].}
}
}
\description{
Computes highest density regions (HDRs) for a numeric sample using a kernel
density estimate. For multimodal densities, the HDR can consist of multiple
disjoint intervals.
}
\details{
The Monte Carlo integration option follows the approach described by
Hyndman (1996) for computing HDRs from an estimated density.
}
\references{
Hyndman, R. J. (1996). Computing and graphing highest density regions.
The American Statistician, 50(2), 120â€“126. \doi{10.2307/2684423}
}
